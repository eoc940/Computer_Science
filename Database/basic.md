## 데이터베이스

특정 조직의 여러 사용자가 공유하여 사용할 수 있도록 통합해서 저장한 운영 데이터의 집합이다

데이터베이스의 특징과 예제를 합쳐 설명하면

데이터베이스의 특징 - 쇼핑몰 예제
- 실시간 접근 가능 -> 목록 조회
- 계속적으로 변화 -> 구입정보, 물건재고 정보
- 동시 공유가 가능 -> 많은 고객이 동시 접속, 구매 가능
- 저장된 주소가 아닌 내용으로 참조 가능 -> 가장 많이 팔린 제품은?



### 데이터베이스 용어정리

데이터베이스 기본 용어를 먼저 정리하겠다

### 데이터베이스 관리시스템(DBMS)
- 파일시스템의 데이터중복과 데이터 종속 문제를 해결하기 위해 제시된 소프트웨어
- 데이터베이스의 생성과 관리를 담당
- 모든 응용프로그램은 데이터베이스 공유 가능, DBMS 통해 데이터 삽입, 수정, 검색

### DBMS 주요 기능과 장단점
- 정의 기능 : 데이터베이스 구조를 정의하거나 수행
- 조작 기능 : 데이터를 삽입, 삭제, 수정, 검색하는 연산을 수행
- 제어 기능 : 데이터를 항상 정확하고 안전하게 유지하는 기능

#### [장점]
- 파일시스템의 데이터 중복 문제 해결
- 데이터 독립성 확보(데이터 구조가 바뀌어도 응용프로그램을 바꿀 필요 없음)
- 데이터 동시 공유(Concurrency control) : 동시성 제어
- 데이터 보안 향상 : 사용자별 접근 가능한 데이터베이스 영역 제한 가능
- 데이터 무결성 유지
- 표준화 방식으로 데이터에 접근(with 데이터베이스 언어)
- 장애 발생 후 회복 시 데이터 일관성과 무결성 유지 : 트랜잭션 가능
- 응용 프로그램 개발 비용이 줄어듬

#### [단점]
- DBMS 구매 비용
- 응용프로그램이 DBMS를 통해 데이터에 접근하기 때문에 추가적인 오버헤드가 있다
- 응용프로그래머가 DBMS가 어떻게 동작하는지와 표준 데이터 언어에 대한 지식 필요
- DBMS 장애가 발생할 때 모든 응용프로그램 장애가 발생함

#### Data Dictionary(System Catalog)
- DBMS는 database와 함께 metadata(data about data)를 저장한다
- 데이터 정의어(DDL)에 의해 생성된다

#### Metadata
- 각 데이터에 접근할 수 있는 데이터의 이름(테이블, 컬럼 이름)
- 스토리지에 데이터가 저장된 위치
- 보안을 위한 제약(security constraint) : 누가 어떤 데이터를 접근할 수 있나
- 무결성을 위한 제약(integrity constraint) : 어떤 값이 데이터에 유효하나

### 테이블(Table)
- 행과 열로 이루어진 데이터의 집합을 테이블이라고 한다
- 흔히 생각하는 엑셀을 떠올리면 편하다
- 일반적인 데이터베이스에서는 행과 열만 있으면 테이블이라고 하지만, 관계형 데이터베이스에서는 여기에 특별한 제약을 추가해서
```릴레이션(Relation)```이라고 부른다
- 아래 조건을 충족하는 테이블만이 릴레이션이 될 수 있기 때문에 모든 릴레이션은 테이블이지만, 모든 테이블이 릴레이션인건 아니다

1. 모든 값은 유일한 값을 가진다
2. 하나의 릴레이션에서 중복되는 행이 존재하면 안된다

### 행(Row)
- 테이블을 구성하는 데이터들 중 가로로 묶은 데이터셋을 의미한다
- 일반적으로 행은 한 객체에 대한 정보를 가지고 있다
- 이또한 관계형 데이터베이스에서는 튜플 또는 레코드라는 이름으로 불린다

### 열(Column)
- 테이블을 구성하는 데이터들 중 세로로 묶은 데이터셋을 의미한다
- 일반적으로 열은 그 테이블의 속성을 의미하며 열을 구성하는 값들은 ```도메인(Domain)```으로 되어 있다
- 이 또한 관계형 데이터베이스에서는 ```속성(Attribute)```이라는 이름으로 불린다

### 도메인(Domain)
- 데이터베이스에서 필드(Field)에 채워질 수 있는 값의 집합이다
- 예를 들어, 도메인이 1에서 10사이의 정수인 속성의 필드에 11이나 -1처럼 도메인을 벗어나는 값 또는 "고양이"처럼 아예 자료형이
다른 값이 들어갈 수 없다

### 스키마(Schema)
- 데이터베이스의 논리적 구조와 제약조건을 전반적으로 기술한 것을 말한다
- 구체적으로 데이터베이스를 구성하는 데이터 레코드의 크기, 키의 정의, 레코드 간의 관계 등을 정의한 것을 말한다
- 사용자의 관점에 따라 외부 스키마, 개념 스키마, 내부 스키마로 구분한다
- DBMS는 외부 스키마에 명세된 사용자의 요구를 개념 스키마 형태로 변환하고, 이를 다시 내부 스키마 형태로 변환한다

![image](https://user-images.githubusercontent.com/67304980/135084493-b60028ed-69a8-4a72-a662-d9a0743ac2d7.png)


![image](https://user-images.githubusercontent.com/67304980/133926839-a2c3e6f1-8903-485b-8984-adc280e4505f.png)

인스턴스(instance) : 정의된 스키마에 따라 데이터베이스에 실제로 저장된 값

### 3단계 데이터베이스 구조(3 level database architecture)

미국의 기관인 ANSI/SPARC에서 데이터베이스의 내부 구조를 감추고 일반 사용자가 데이터베이스를 쉽게 이용하고
사용할 수 있게 하는 구조 제안

![image](https://user-images.githubusercontent.com/67304980/135084657-c21e916f-8160-4115-b3c2-7c9c84d940a0.png)


#### 외부 스키마
- 사용자의 입장에서 정의한 데이터베이스의 논리적 구조(사용자가 보는 view level)
- 사용자에게 view의 형태로 필요한 정보만 보여주는 단계
- 데이터들을 어떤 형식, 구조, 화면을 통해 사용자에게 보여줄 것인가에 대한 명세를 말하며 하나의 데이터베이스에는 여러 개의
외부 스키마가 있을 수 있다(각 사용자가 생각하는 데이터베이스의 모습, 논리적 구조로 사용자마다 다른 모습)
- 일반 사용자에게는 질의어를 이용해 DB를 쉽게 사용할 수 있도록 하고 응용 프로그래머는 언어를 사용해서 DB에 접근하도록 한다
- 각 사용자들이 개별 요구 사항에 따라 다른 view를 정의해서 데이터를 볼 수 있다
- 데이터베이스 하나에 여러 개의 외부 스키마 

#### 개념 스키마
- 일반적인 스키마
- 조직체 전체를 관장하는 입장에서 DB를 정의한 스키마(데이터베이스 하나에 개념 스키마가 하나만 존재함)
- DB에 대한 모든 논리적 구조를 기술하기 때문에 데이터베이스에 하나만 존재하며, 통상 스키마라고 하면 개념 스키마를 일컫는다
- 전체 데이터베이스에 어떤 데이터가 저장되는지, 데이터들 간에는 어떤 관계가 존재하고 어떤 제약조건이 존재하는지에 대한 정의뿐만 아니라, 데이터에 대한 보안 정책이나 접근 권한에 대한 정의도 포함(데이터를 효과적으로 관리하기 위한 다양한 기능 개념)

#### 내부 스키마
- 데이터베이스 하나에 내부 스키마가 하나만 존재함
- 데이터베이스가 어떻게 저장 장치에 저장될지에 대한 명세
- 레코드 구조(사이즈), 필드 크기, 레코드 접근 경로, 압축방법, 암호화 방법 등 물리적인 저장 구조를 정의
- 물리적인 저장 장치와 데이터베이스 간의 관계를 정의하므로 시스템 프로그래머나 시스템 설계자가 보는 관점의 스키마이다

![image](https://user-images.githubusercontent.com/67304980/133927270-bfb3c544-09fc-46f0-b92b-6d92885249a2.png)

![image](https://user-images.githubusercontent.com/67304980/133927276-8893ab87-e79b-4027-a3ae-e956ad086f9c.png)


### 3단계 데이터베이스 구조의 사상 또는 매핑

- 데이터의 독립성 실현
- 스키마 사이의 대응 관계 / 관계와 관계를 정의하는 것
- 미리 정의된 사상 정보를 이용하여 사용자가 원하는 데이터에 접근(고객분석팀에서 고객 정보 데이터 접근)
- 데이터베이스를 3단계 구조로 나누고 단계별로 스키마를 유지하며 스키마 사이의 대응 관계를 정의하는 목적

![image](https://user-images.githubusercontent.com/67304980/133927342-0f6d2338-fa05-4ac8-82aa-6a517ba468d4.png)

1) 외부/개념 사상 - 응용 인터페이스(application interface)
- 외부 스키마와 개념 스키마의 대응 관계

2) 개념/내부 사상 - 저장 인터페이스(storage interface)
- 개념 스키마와 내부 스키마의 대응 관계

### 데이터 독립성(Data Independency)
- 파일 시스템의 종속성 문제 해결
- 하위 스키마를 변경하더라도 상위 스키마가 영향을 받지 않는 특성

1) 논리적 데이터 독립성(응용 인터페이스 독립성 유지)
- 개념 스키마가 변경되어도 외부 스키마가 영향을 받지 않음
- 개념 스키마가 변경되면 관련된 외부/개념 사상만 정확하게 수정해주면 됨

2) 물리적 데이터 독립성(저장 인터페이스 독립성 유지)
- 내부 스키마가 변경되어도 개념 스키마는 영향을 받지 않음
- 내부 스키마가 변경되면 관련된 개념/내부 사상만 정확하게 수정해주면 됨


### 데이터베이스 사용자
1. 데이터베이스 관리자(DBA)
    - 데이터베이스 시스템을 운영하고 관리
    - 데이터베이스를 설계 및 구축, 제어
    - DBMS 자체는 물론 데이터베이스 구축, 관리에 해박한 지식과 많은 경험이 요구됨

2. 응용 프로그래머
    - 데이터베이스 언어를 이용하여 응용프로그램을 작성

3. 최종 사용자(End User)
    - 데이터베이스에 접근하여 데이터를 조작
    - casual end user : 데이터베이스 언어를 이용해 데이터베이스 접근 및 조작
    - native end user : 데이터베이스 언어를 쓰지 않고 응용프로글매을 통해 데이터베이스 접근

![image](https://user-images.githubusercontent.com/67304980/135086041-f7c5051d-1ae4-4457-9ae3-cea4a782d0e8.png)

### 질의 처리기

DDL Interpreter
- DDL로 작성된 스키마의 정의를 해석, 데이터 딕셔너리(Catalog)에 저장

DML Compiler
- DML로 작성된 데이터 처리 요구를 processing engine이 이해할 수 있는 코드로 해석하여 plan을 작성

DML(Query) Processing Engine
- 컴파일된 plan을 데이터베이스에 실제로 실행

![image](https://user-images.githubusercontent.com/67304980/135086630-c5b81a62-1063-44c6-bebb-6754f27c8919.png)














